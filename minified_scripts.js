document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".modal-button").forEach(e=>{let t=document.createElement("span");t.setAttribute("class","modal-button-icon");let i=document.createTextNode("ⓘ");t.appendChild(i),e.appendChild(t),e.addEventListener("click",()=>{e.parentElement.previousElementSibling.classList.remove("hide"),document.querySelector("html").classList.add("overflow-hidden")})}),document.querySelectorAll(".modal-close, .button-close").forEach(e=>{e.addEventListener("click",()=>{e.parentElement.parentElement.parentElement.parentElement.parentElement.classList.add("hide"),document.querySelector("html").classList.remove("overflow-hidden")})});let e=document.querySelector(".nav-wrapper");function t(e){if(isNaN(e))return NaN;for(var t=String(+e).split(""),i=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],a="",r=3;r--;)a=(i[+t.pop()+10*r]||"")+a;return Array(+t.join("")+1).join("M")+a}function i(t,i){t.forEach(t=>{t.target.classList.remove("is-intersect"),document.body.classList.remove("map-label-theme-light"),e.querySelectorAll(".nav-scroll").forEach(e=>{e.classList.remove("theme-light")}),document.querySelectorAll(".nav-link").forEach(e=>{e.classList.remove("theme-light")}),t.isIntersecting&&(t.target.classList.add("is-intersect"),t.target.parentElement.classList.contains("chapter")&&(document.querySelectorAll(".chapter").forEach(e=>{e.classList.remove("is-active")}),t.target.parentElement.classList.add("is-active")))})}document.querySelectorAll(".burger-button").forEach(t=>{t.addEventListener("click",()=>{e.classList.add("is-burger"),t.nextElementSibling.classList.remove("hide"),document.querySelector("html").classList.add("overflow-hidden")})}),document.querySelectorAll(".burger-button-close").forEach(t=>{t.addEventListener("click",()=>{e.classList.remove("is-burger"),t.parentElement.parentElement.classList.add("hide"),document.querySelector("html").classList.remove("overflow-hidden")})});let a=new IntersectionObserver(i,{root:null,threshold:0});document.body.scrollHeight,document.addEventListener("scroll",()=>{let t=document.querySelector(".is-intersect"),i=document.querySelector(".chapter.is-active");t&&window.pageYOffset+t.offsetTop>window.innerHeight&&(t.classList.contains("theme-light")?(document.body.classList.add("map-label-theme-light"),e.querySelectorAll(".nav-scroll").forEach(e=>{e.classList.add("theme-light")})):e.querySelectorAll(".nav-scroll").forEach(e=>{document.body.classList.remove("map-label-theme-light"),e.classList.remove("theme-light")}),document.querySelectorAll(".nav-link").forEach(e=>{t.classList.contains("theme-light")?e.classList.add("theme-light"):e.classList.remove("theme-light"),e.classList.remove("is-active"),e.dataset.index==i.dataset.index&&e.classList.add("is-active")})),e.classList.add("hide"),window.pageYOffset>window.innerHeight&&e.classList.remove("hide");let a=document.querySelectorAll(".nav-scroll");document.querySelectorAll(".chapter").forEach((e,t)=>{let i=e.scrollHeight,r=e.offsetTop-e.scrollTop+e.clientTop;if(window.pageYOffset>=r&&window.pageYOffset<r+i){let n=(window.pageYOffset-r)*100/i;a.forEach((e,i)=>{t<i?e.style.width="0%":t>i&&(e.style.width="100%")}),a[t].style.width=`${n}%`}})}),document.querySelectorAll(".section").forEach(e=>{a.observe(e)}),document.querySelectorAll(".chapter").forEach(i=>{let a="",r="";i.classList.forEach(e=>{e.includes("chapter-")&&(r=(a=e.split("chapter-").pop()).replaceAll("_"," "))}),i.offsetHeight;let n=e.childElementCount;i.setAttribute("id",`${a}`),i.setAttribute("data-index",`${n}`);let l=document.createElement("div");l.setAttribute("class","nav-link"),l.setAttribute("data-index",`${n}`);let o=document.createElement("a");o.setAttribute("href",`#${a}`);let s=document.createTextNode(`${t(n)}. ${r}`);o.appendChild(s),l.appendChild(o),e.appendChild(l);let c=document.createElement("div");c.setAttribute("class","nav-scroll-chapter");let d=document.createElement("div");d.setAttribute("class","nav-scroll"),c.appendChild(d),document.querySelector(".nav-scroll-wrapper").appendChild(c)});let r=document.querySelector(".add-flourish .mb-scrollytelling_content-wrapper .text-rich-text"),n=document.createElement("div");n.className="flourish-embed flourish-chart",n.setAttribute("data-src","visualisation/15224980");let l=document.createElement("script");l.src="https://public.flourish.studio/resources/embed.js",n.appendChild(l),r.appendChild(n);let o=document.getElementById("nigeria-community-1"),s=o.querySelector(".text-rich-text");console.log(s);let c=document.createElement("div");c.className="image-container_borno";let d=document.createElement("img");d.src="https://uploads-ssl.webflow.com/65323ee33f55c1a97dd6dcc3/655dca9d880a17cfee2e2083_borno_aerial2.webp",d.alt="Aerial view of Maiduguri",c.appendChild(d),s.appendChild(c);let p=document.querySelector(".copy");function y(e){e.preventDefault();var t=document.createElement("textarea");t.style.position="fixed",t.style.top=0,t.style.left=0,t.style.width="2em",t.style.height="2em",t.style.padding=0,t.style.border="none",t.style.outline="none",t.style.boxShadow="none",t.style.background="transparent",t.value="https://nigeria.makepoliohistory.org",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")&&alert("The text has been copied!")}catch(i){console.log("Oops, unable to copy")}document.body.removeChild(t)}console.log("ok",p),p.addEventListener("click",y),mapboxgl.accessToken="pk.eyJ1IjoiYnVyaWVkc2lnbmFscyIsImEiOiJjbDBhdmlhZTgwM3dtM2RxOTQ5cndsYXl0In0.Gvcq3DBOKDVRhy3QLjImiA";var u,h,m="mapbox://styles/buriedsignals/clnaapgmw03md01qx182ndz1h",$="mapbox://styles/buriedsignals/clnybvpbh000g01qx3alt4tki",v=new mapboxgl.Map({container:"map",style:m,center:[9.4,8.7],zoom:2,pitch:0,bearing:0,antialias:!0,interactive:!1});let g=e=>document.querySelector(e),b=g("#date-label"),f=g("#case-count"),_=g("#case-count-wrap"),L=g(".legends-wrapper"),E=()=>{L.innerHTML=""},k=(e,t,i)=>{let a=document.createElement("div");a.className=`legend theme-${e}`;let r=document.createElement("div");r.className="legend-visual",t.forEach((e,t)=>{let i=document.createElement("div");i.className="legend-visual-circle",t>0&&i.classList.add("more"),i.style.backgroundColor=e,r.appendChild(i)});let n=document.createElement("p");n.className=`legend-text theme-${e}`,n.innerHTML=i,a.appendChild(r),a.appendChild(n),L.appendChild(a)};var C=[9.4,8.7],w={"nigeria-wild-1":{duration:3e3,bearing:0,center:C,zoom:5},"nigeria-wild-2":{center:C,bearing:0,zoom:5},"nigeria-variant-1":{duration:3e3,bearing:0,center:C,zoom:5.25},"nigeria-variant-2":{center:C,bearing:0,zoom:5.25},"nigeria-northern":{center:C,bearing:0,zoom:5.25},"nigeria-risk-1":{duration:5e3,bearing:0,center:[1.011,5.97],zoom:3},"nigeria-risk-2":{duration:5e3,center:[1.011,5.9],bearing:0,zoom:3},"nigeria-vaccine-1":{bearing:0,center:C,zoom:5},"nigeria-vaccine-2":{bearing:0,center:C,zoom:4},"nigeria-community-1":{center:[13.149859346174907,11.828444442660588],duration:5e3,bearing:0,zoom:9},"polio-eradication-1":{center:[1.011,5.9],bearing:0,zoom:3.5},"polio-eradication-3":{duration:5e3,bearing:0,center:[1.011,5.9],zoom:3.5}},P=["nigeria-wild-2","nigeria-wild-1","nigeria-variant-1","nigeria-variant-2","nigeria-risk-2","nigeria-risk-1","nigeria-northern"],A=["nigeria-vaccine-1","nigeria-vaccine-2","nigeria-community-1","polio-eradication-1","polio-eradication-3"];function S(){v.setPaintProperty("expanding-polio","fill-color",["match",["get","name_en"],"Nigeria","#f8cd6b","#803118"])}function q(e,t={duration:6e3}){var i;v.setPaintProperty(e,"fill-opacity",1),v.setPaintProperty(e,"fill-color","#e6dec1");let a=t.duration??6e3;b.style.display="none",_.style.display="none",cancelAnimationFrame(u),cancelAnimationFrame(h);let r=t=>{i||(i=t);let n=t-i,l=n/a;if(l>=1){cancelAnimationFrame(h),h=null;return}v.setPaintProperty(e,"fill-color",["interpolate",["linear"],["get","total_immunized"],17984889-12127105*l-1,"#e6dec1",17984889+(1-l)*12127105,"#94da92"]),h=requestAnimationFrame(r)};h=requestAnimationFrame(r)}function D(e,t=()=>!0){var i=0;return v.queryRenderedFeatures({layers:[e]}).forEach(({properties:e})=>{i+=t(e)?1:0}),i}let x=e=>new Date(e).getTime(),I={"wild-polio":{start:x("2001-01-11"),peak:x("2008-10-10"),end:x("2016-01-01")},"variant-polio":{start:x("2010-02-17"),peak:x("2022-03-01"),end:x("2023-11-01")}};var z=50;function F(e,t={to:"peak",from:"start"}){let{to:i,from:a}=t,r=I[e][i],n=I[e][a],l=t.duration??15e3,o=t.dateWindow??31536e6;b.style.display="inline",_.style.display="inline",cancelAnimationFrame(u);var s,c=0;let d=t=>{s||(s=t);let i=t-s,a=i/l;if(i-c<z){u=requestAnimationFrame(d);return}if(a>=1)return cancelAnimationFrame(u);let p=n+a*(r-n),y=p-o;v.setPaintProperty(e,"circle-opacity",["case",["all",[">=",["get","dateInt"],y],["<=",["get","dateInt"],p],],1,0]),b.innerText=[y,p].map(e=>new Date(e).toLocaleDateString("en-US",{year:"numeric"})).join(" – "),f.innerText=D(e,e=>e.dateInt>=y&&e.dateInt<=p),c=i,u=requestAnimationFrame(d)};u=requestAnimationFrame(d)}function T(e,t){let i,a=0;function r(){let n=v.queryRenderedFeatures({layers:[e]});if(0===n.length){requestAnimationFrame(r);return}let l=n.map(e=>e.properties.dateInt),o=Math.min(...l),s=Math.max(...l),c=r=>{i||(i=r);let n=r-i,l=n/t;if(n-a<100){requestAnimationFrame(c);return}if(l>=1){v.setPaintProperty(e,"circle-opacity",0);return}v.setPaintProperty(e,"circle-opacity",["case",["<",["get","dateInt"],o+l*(s-o)],0,1]),a=n,requestAnimationFrame(c)};requestAnimationFrame(c)}v.once("idle",r)}window.onscroll=function(){for(var e=Object.keys(w),t=0;t<e.length;t++){var i=e[t],a=0;switch(i){case"nigeria-risk-2":a=-(.5*window.innerHeight);break;case"nigeria-vaccine-1":case"nigeria-risk-1":a=.75*window.innerHeight}if(O(i,a)){H(i);break}}};var X="nigeria-wild-2",B=m;function H(e){if(e!==X){g(`#${e}`).setAttribute("class","active"),g(`#${X}`).setAttribute("class",""),X=e,v.flyTo({padding:{left:200},...w[e]});var t=A.includes(e)?$:P.includes(e)?m:B;!function i(){switch(e){case"nigeria-wild-1":E(),k("dark",["#F4693D"],"Each dot represents a child paralyzed by wild polio");case"nigeria-wild-2":v.setLayoutProperty("wild-polio","visibility","visible"),v.setLayoutProperty("variant-polio","visibility","none"),F("wild-polio",{to:"nigeria-wild-1"===e?"peak":"end",from:"nigeria-wild-1"===e?"start":"peak",duration:6e3}),E(),k("dark",["#F4693D"],"Each dot represents a child paralyzed by wild polio");break;case"nigeria-variant-1":E(),k("dark",["#F8CD6B"],"Each dot represents a child paralyzed by variant polio"),k("dark",["#CFDFFF","#EAAB1D"],"Different colors represent distinct families of the virus");case"nigeria-variant-2":v.setLayoutProperty("northern-states","visibility","none"),v.setLayoutProperty("northern-states-borders","visibility","none"),v.setLayoutProperty("wild-polio","visibility","none"),v.setLayoutProperty("expanding-polio","visibility","none"),v.setLayoutProperty("variant-polio","visibility","visible"),E(),k("dark",["#F8CD6B"],"Each dot represents a child paralyzed by variant polio"),k("dark",["#CFDFFF","#EAAB1D"],"Different colors represent distinct families of the virus"),"nigeria-variant-1"===e&&F("variant-polio",{to:"peak",from:"start",dateWindow:31536e6});break;case"nigeria-northern":v.setLayoutProperty("northern-states","visibility","visible"),v.setLayoutProperty("northern-states-borders","visibility","visible"),v.setLayoutProperty("variant-polio","visibility","none"),E();break;case"nigeria-risk-1":v.setLayoutProperty("northern-states","visibility","none"),v.setLayoutProperty("northern-states-borders","visibility","none"),v.setLayoutProperty("expanding-polio","visibility","visible"),_.style.display="none",b.style.display="none",E();break;case"nigeria-risk-2":t!==B?(v.setStyle(t),v.on("style.load",()=>{S(),B=t})):S(),_.style.display="none",b.style.display="none",E();break;case"nigeria-vaccine-1":v.setLayoutProperty("variant-polio","visibility","none"),t!==B?(v.setStyle(t),v.on("style.load",()=>{v.setLayoutProperty("immunized-population","visibility","visible"),q("immunized-population"),B=t})):(v.setLayoutProperty("immunized-population","visibility","visible"),q("immunized-population")),E(),k("light",["#94da92"],"Shadings represent number of SIAs completed");break;case"nigeria-vaccine-2":v.setLayoutProperty("variant-polio","visibility","visible"),v.setLayoutProperty("immunized-population","visibility","none"),v.setLayoutProperty("nigeria-community-cases","visibility","none"),E(),k("light",["#F8CD6B"],"Each dot represents a child paralyzed by variant polio"),k("light",["#CFDFFF","#EAAB1D"],"Different colors represent distinct families of the virus"),F("variant-polio",{to:"end",from:"peak",duration:8e3,dateWindow:31536e6});break;case"nigeria-community-1":_.style.display="none",b.style.display="none",v.setLayoutProperty("nigeria-community-cases","visibility","visible"),v.setLayoutProperty("variant-polio","visibility","none"),v.setLayoutProperty("nigeria-2023-cases","visibility","none"),E(),k("light",["#709CF2"],"Each dot represents a variant polio case"),T("nigeria-community-cases",3e3);break;case"polio-eradication-1":_.style.display="none",b.style.display="none",v.setLayoutProperty("variant-polio","visibility","none"),v.setLayoutProperty("nigeria-2023-cases","visibility","visible"),v.setLayoutProperty("nigeria-community-cases","visibility","none"),E(),k("light",["#F8CD6B"],"Each dot represents a child paralyzed by variant polio"),k("light",["#CFDFFF","#EAAB1D"],"Different colors represent distinct families of the virus");break;case"polio-eradication-3":T("nigeria-2023-cases",3e3)}}()}}function O(e,t=0){var i=g(`#${e}`);if(!i)return!1;var a=i.getBoundingClientRect();return a.top<window.innerHeight+t&&a.bottom>300}});